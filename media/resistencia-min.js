function optColorBands(){for(var e,n=namesArray[languageSelect][0],t=1;t<=colorBandArray.length;t++)e=document.getElementById("band"+t),selectAddOptions(e,colorBandArray[t-1],colorNameArray[languageSelect]),document.getElementById("titBand"+t).innerHTML=n+" "+t+": ";n=namesArray[languageSelect][1],document.getElementById("lblTitCalc").innerHTML=n,bandChange(),document.getElementById("cmbResToler")[0].selected=!0,LanguageShowHide()}function selectAddOptions(e,n,t){for(var a=0;a<n.length;a++){var d=document.createElement("option");d.text=t[n[a]],e.add(d)}}function colorChange(){for(var e,n,t=0,a=1;5>=a;a++)t=document.getElementById("band"+a),itemSelected=t.selectedIndex,itemSelected>0?(n=colorBandArray[a-1][itemSelected-1],bandValue[a-1]=n,e=cart_pref+colorNameArray[0][n]+est):(bandValue[a-1]=-1,e=vuoto),optBand5||3!=a?document.getElementById("imgBand"+a).src=e:document.getElementById("imgBand"+(a+1)).src=e,5==a&&(document.getElementById("cmbResToler")[itemSelected].selected=!0);document.getElementById("txtResValue").value=ohmsFormat(ResCalc())}function changeToler(e){var n,t;e.selectedIndex>0?(t=colorBandArray[4][e.selectedIndex-1],n=cart_pref+colorNameArray[0][t]+est):n=vuoto,document.getElementById("imgBand5").src=n,document.getElementById("band5").selectedIndex=e.selectedIndex}function returnResValue(e){13==e.keyCode&&valueToColors()}function valueToColors(){var e,n=1,t=0,a=0,d=document.getElementById("txtResValue").value;if(d=d.toUpperCase(),d=d.replace(",","."),d=d.replace("OHM",""),d=d.replace("S",""),d.search("K")>=0?n=1e3:d.search("M")>=0&&(n=1e6),d=d.replace(/[ KM]/g,""),t=d*n,n=0,optBand5){for(;t>=1e3;)t/=10,n++,1e3>t&&Math.round(t)!=t&&(t=Math.round(t),a=1);for(10>t?(t*=100,n=11):100>t&&(t*=10,n=10),t=""+t;t.length<3;)t="0"+t;e=cart_pref+colorNameArray[0][t[0]]+est,document.getElementById("imgBand1").src=e,document.getElementById("band1").selectedIndex=parseInt(t[0])+1,e=cart_pref+colorNameArray[0][t[1]]+est,document.getElementById("imgBand2").src=e,document.getElementById("band2").selectedIndex=parseInt(t[1])+1,e=cart_pref+colorNameArray[0][t[2]]+est,document.getElementById("imgBand3").src=e,document.getElementById("band3").selectedIndex=parseInt(t[2])+1,e=cart_pref+colorNameArray[0][n]+est,document.getElementById("imgBand4").src=e,parseInt(n)<10?document.getElementById("band4").selectedIndex=parseInt(n)+1:document.getElementById("band4").selectedIndex=parseInt(n)-1}else{for(;t>=100;)t/=10,n++,100>t&&Math.round(t)!=t&&(t=Math.round(t),a=1);1>t?(t*=100,n=11):10>t&&(t*=10,n=10),t=""+t,t.length<2&&(t="0"+t),e=cart_pref+colorNameArray[0][t[0]]+est,document.getElementById("imgBand1").src=e,document.getElementById("band1").selectedIndex=parseInt(t[0])+1,e=cart_pref+colorNameArray[0][t[1]]+est,document.getElementById("imgBand2").src=e,document.getElementById("band2").selectedIndex=parseInt(t[1])+1,e=cart_pref+colorNameArray[0][n]+est,document.getElementById("imgBand4").src=e,parseInt(n)<10?document.getElementById("band4").selectedIndex=parseInt(n)+1:document.getElementById("band4").selectedIndex=parseInt(n)-1}}function bandChange(){optBand5=document.getElementById("optBand5").checked,optBand5?(document.getElementById("titBand3").innerHTML=namesArray[languageSelect][0]+" 3: ",document.getElementById("titBand4").innerHTML=namesArray[languageSelect][0]+" 4: ",document.getElementById("titBand5").innerHTML=namesArray[languageSelect][0]+" 5: ",document.getElementById("riga3").style.display="table-row"):(document.getElementById("titBand3").innerHTML="",document.getElementById("titBand4").innerHTML=namesArray[languageSelect][0]+" 3: ",document.getElementById("titBand5").innerHTML=namesArray[languageSelect][0]+" 4: ",document.getElementById("riga3").style.display="none",document.getElementById("imgBand4").src=vuoto),document.getElementById("txtResValue").value=ohmsFormat(ResCalc()),resetData()}function resetData(){document.getElementById("band1").selectedIndex=0,document.getElementById("band2").selectedIndex=0,document.getElementById("band3").selectedIndex=0,document.getElementById("band4").selectedIndex=0,document.getElementById("band5").selectedIndex=0,document.getElementById("cmbResToler").selectedIndex=0,document.getElementById("txtResValue").value="",document.getElementById("imgBand1").src=vuoto,document.getElementById("imgBand2").src=vuoto,document.getElementById("imgBand3").src=vuoto,document.getElementById("imgBand4").src=vuoto,document.getElementById("imgBand5").src=vuoto,bandValue=[-1,-1,-1,-1,-1]}function ResCalc(){var ohms=0;return optBand5?bandValue[0]>-1&&bandValue[1]>-1&&bandValue[2]>-1&&bandValue[3]>-1&&(ohms=100*bandValue[0]+10*bandValue[1]+bandValue[2],ohms=eval(""+ohms+"e"+multiplierArray[bandValue[3]])):bandValue[0]>-1&&bandValue[1]>-1&&bandValue[3]>-1&&(ohms=10*bandValue[0]+bandValue[1],ohms=eval(""+ohms+"e"+multiplierArray[bandValue[3]])),ohms}function ohmsFormat(e){return e>=1e9?(e/=1e9,""+e+" Gohms"):e>=1e6?(e/=1e6,""+e+" Mohms"):e>=1e3?(e/=1e3,""+e+" Kohms"):0==e?"":""+e+" ohms"}var languageSelect=1,templanguage=0,optBand5,multiplierArray=[0,1,2,3,4,5,6,7,8,9,-1,-2],bandValue=[-1,-1,-1,-1,-1],colorNameArray=new Array,colorBandArray=new Array,namesArray=new Array;colorNameArray[0]=["black","brown","red","orange","yellow","green","blue","violet","grey","white","gold","silver"],colorNameArray[1]=["negro +0","marron +1","rojo +2 ","naranja +3","amarillo +4","verde +5","azul +6","violeta +7","gris +8","blanco +9","dorado -1","plateado -2"];var cart=String.fromCharCode(109,101,100,105,97,47),est=String.fromCharCode(46,112,110,103);colorBandArray[0]=[0,1,2,3,4,5,6,7,8,9],colorBandArray[1]=[0,1,2,3,4,5,6,7,8,9],colorBandArray[2]=[0,1,2,3,4,5,6,7,8,9],colorBandArray[3]=[0,1,2,3,4,5,6,7,10,11],colorBandArray[4]=[1],namesArray[1]=["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"];var vuoto=cart+"band_blank"+est,cart_pref=cart+"band_";window.onload=optColorBands;

